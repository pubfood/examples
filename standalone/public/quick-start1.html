<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Pubfood Quick Start 1</title>
        <style>
         body { font-family:'Helvetica Neue', Helvetica, Arial, sans-serif; }
         .question { width: 55%; word-break: normal; }
         .step { width: 100%; float: left; }
         .step-text { width: 450px; word-break: normal; float: left; overflow: hidden }
         .code-sample { width: 600px; margin-left: 2%; float: left; overflow: hidden }
         pre {
             overflow-x: scroll;
         }
         .lines-ref { font-family: monospace }
         .code-ref { font-family: monospace }
        </style>
    </head>
    <body>
        <script>
         function insertStepScript(name, content) {
             var el = document.getElementById(name);
             if (el) {
                 var js = document.createElement('script');
                 js.innerHTML = content;
                 el.parentNode.insertBefore(js, el);
             }
         }

         function insertStepDoc(name, content) {
             var el = document.getElementById(name + '-code');
             if (el) {
                 el.innerHTML = content;
             }
         }

         function getStep(name, doScript) {
             var insertCode = doScript || true;
             var xhr = new XMLHttpRequest();
             xhr.onload = function(e) {
                 if (this.status == 200) {
                     var blob = new Blob([this.response], {type: 'text/javascript'});
                     var reader = new FileReader();
                     reader.addEventListener("loadend", function() {
                         if (insertCode) {
                             insertStepScript(name, reader.result);
                         }
                         insertStepDoc(name, reader.result);
                     });
                     reader.readAsText(blob);
                 }
             };
             xhr.open('GET', '/quick-start1-' + name + '.js', true);
             xhr.responseType = 'blob';
             xhr.send();
         }

         // global for the auction provider
         window.auctionProviderOne = window.auctionProviderOne || {};
         auctionProviderOne.cmd = auctionProviderOne.cmd || [];

         // globals for all bid providers
         window.bidProviderOne = window.bidProviderOne || {};
         bidProviderOne.cmd = bidProviderOne.cmd || [];
        </script>

        <script src="/pubfood.js"></script>

        <h1>Pubfood Quick Start - Simple</h1>
        <div style="width: 60%">
            This guide stages a simple header bidding scenario using brief statements to answer the questions <em>Who?, What?, Why?, When, Where?</em> and <em>How?</em> to result in a bidding partner ad being selected for impression by your ad server.
        </div>
        <h2><a href="#steps"><em>TL;DR to jump to the code...</em></a></h2>
        <h2>Who?</h2>
        <div class="question">
        You are a publisher setting up header bidding on your site. You need a framework
        to facilitate adding bid partners incrementally to your site.
        <p></p>
        Your developers need a simple way to add bid partners to go get a first look at inventory in  your particular ad server.
        </div>
        <h2>What?</h2>
        <div class="question">
        You have an ad server that can auction bids for an impression with key/value targeting line item configuration.
        <p></p>
        You have one bid partner that has a JavaScript library that would make bid requests
        in order to set bid targeting values for your ad server request.
        </div>
        <h2>Why?</h2>
        <div class="question">
        Your bid partner provider can improve the impression yield for your site.
        If you can get your partner's impression bid before the ad server request,
        you can run an ad server auction to prioritize campaign creative selection by revenue channels:
        <p></p>
        <ol>
            <li>Direct sold campaign contracts;</li>
            <li>Partner bid value; and</li>
            <li>Fallback to ad exchanges.</li>
        </ol>
        <p></p>
        A header bidding partner helps improve monetization potential and yield
        for your content page view inventory.
        <p></p>
        Understanding more about header bidding partner performance will help
        you further manage your yield, budget forecasts, sales planning and partnerships.
        <p></p>
        </div>
        <h2>When?</h2>
        <div class="question">
        When a user visits your site, timing is important.
        <p></p>
        Firstly, user experience is critical and page load latency is a very important part of that experience.
        <p></p>
        Therefore, obtaining bidder interest in a pageview within an accepatble
        page load latency window is key to maintaining your brand, user attention and
        monetization of your content page view inventory.
        </div>
        <h2>Where?</h2>
        <div class="question">
            Using Pubfood has minimal impact on your existing investment in development and ad operations.
            Pubfood will have two organizational touch points for your business:
        <p></p>
        <ol>
            <li><b>Your site code</b></li>
            <p>
                Existing site JavaScript code can be used in Pubfood where applicable. For any new bid partner, this integration JavaScript code would be either given to you by the partner or your development team would write the code: in either case, this code can be used by pubfood.
            </p>
            <li><b>Your ad server operations</b></li>
            <p>
                Targeting configuration in your ad server is managed by your ad operations team. Existing line item targeting definitions can be used. Your ad operations team will coordinate with the development team to ensure that the correct targeting keys are supplied to your ad server for decisioning.
            </p>
        </ol>
        </div>
        <h2>How?</h2>
        <div class="question">
        <em>Let's make a few assumptions to set the stage:</em>
        <ol>
            <li>
                you've decided that header bidding will complement revenue generated
                from your publication.
                <p></p>
                But, you want to take it slow and offer one slot only to header bidding
                partners.
                <p></p>
            </li>
            <li>
                you already have direct ad sales and these are serviced using an existing
                ad server service.
                <p></p>
            </li>
            <li>
                your IT development team already have your ad server JavaScript code deployed
                on your site and want to reuse the code.
                <p></p>
            </li>
            <li>
                As they do today with competing direct sold campaigns, your Ad Operations team have told you that they want to setup your ad server with specific line items to target bidders on specific slots and dimensions.
                <p></p>
            </li>
        </ol>
        </div>
        <p></p>
        <h3>Getting started with the Pubfood framework</h3>
        <div id="steps">
        <div class="step">
            <h4><em>The steps</em></h4>
            <div class="step-text">
                <ol>
                    <li><b>Include the pubfood JavaScript library in your code.</b></li>
                    <p></p>
                    <li><b><span class="code-ref">food.addSlot(...);</span></b></li>
                    <p>Define slots and which partner may bid for them.</p>
                    <li><b><span class="code-ref">food.addBidProvider(...);</span></b></li>
                    <p>Define or copy your bidding partner JavaScript code.</p>
                    <p>
                    <ol>
                        <li>on each bid, call the <b><span class="code-ref">pushBid({})</span></b> callback</li>
                        <li>when bidding finished, call the <b><span class="code-ref">done()</span></b> callback</li>
                    </ol>
                    </p>
                    <li><b><span class="code-ref">food.setAuctionProvider(...);</span></b></li>
                    <p>Define or copy your ad server JavaScript code to send bids to auction.</p>
                    <li><b><span class="code-ref">food.observe('AUCTION_POST_RUN', ...);</span></b></li>
                    <p>Define where to display your ad.</p>
                    <li>
                        <b><span class="code-ref">food.start();</span></b><br>
                        <b><span class="code-ref">food.timeout(...);</span></b>
                    </li>
                    <p>Set a bidder timeout and start the pubfood auction.</p>
                    </ol>
            </div>
            <div id="theAd" class="code-sample">
                <b><em>How did this ad get here?</em></b>
                <pre id="div-rail"></pre>
            </div>
        </div>
        <div class="step">
            <h4>Include the pubfood library in your site code</h4>
            <div class="step-text">To execute the following steps in your own code, you will need to include the pubfood JavaScript library.</div>
            <div class="code-sample">
                <b><a href="https://github.com/pubfood/pubfood/tree/master/dist">https://github.com/pubfood/pubfood/tree/master/dist</a></b>
                <pre id="step0-code" class="prettyprint linenums">
                </pre>
            </div>
        </div>
        <div class="step">
            <h4>Define slots</h4>
            <div class="step-text">You will tell Pubfood which of your ad server slots are available for bidding and which partners may bid for therm.</div>
            <div class="code-sample">
                <pre id="step1-code" class="prettyprint linenums">
                </pre>
            </div>
        </div>
        <div class="step">
            <h4>Define bidding partner</h4>
            <div class="step-text">Pubfood does not need to know much about how your bid provider works. What it does need to know is:
                <ul>
                    <li><span class="lines-ref">line 2</span> - the bidder name</li>
                    <li><span class="lines-ref">line 3</span> - the bid provider JavaScript library to load</li>
                    <li><span class="lines-ref">line 4</span> - bidder specific config for slots. in this case the bidder has it's own identifier for the <span class="code-ref">/2476204/rail</span> slot</li>
                    <li><span class="lines-ref">line 8</span> - the function to initialize bids</li>
                    <ul>
                        <li><span class="lines-ref">line 38</span> - submit a bid with the <span class="code-ref">pushBid({})</span> callback</li>
                        <li><span class="lines-ref">line 49</span> - notify pubfood when done with the  <span class="code-ref">done()</span> callback</li>
                    </ul>
                    <li><span class="lines-ref">line 52</span> The function to refresh bids</li>
                </ul>
            </div>
            <div class="code-sample">
                <pre id="step2-code" class="prettyprint linenums">
                </pre>
            </div>
        </div>
        <div class="step">
            <h4>Define your ad server</h4>
            <div class="step-text">Set your auction provider that will receive bid targeting and send the targeting to auction in your ad server.
                <ul>
                    <li><span class="lines-ref">line 2</span> - the auction provider name</li>
                    <li><span class="lines-ref">line 3</span> - the auction provider JavaScript library to load</li>
                    <li><span class="lines-ref">line 5</span> - the function to initialize the auction</li>
                    <ul>
                        <li><span class="lines-ref">line 36</span> - notify pubfood when done with the  <span class="code-ref">done()</span> callback</li>
                    </ul>
                    <li><span class="lines-ref">line 52</span> - the function to refresh with a new auction for slots</li>
                </ul>
            </div>
            <div class="code-sample">
                <pre id="step3-code" class="prettyprint lang-js linenums">
                </pre>
            </div>
        </div>
        <div class="step">
            <h4>Define when to display ads</h4>
            <div class="step-text">When pubfood has completed the auction orchestration, it will raise an event to indicate ads are ready to display.
                <ul>
                    <li><span class="lines-ref">line 1</span> - observe the auction provider name</li>
                    <li><span class="lines-ref">line 3</span> - the auction provider JavaScript library to load</li>
                    <li><span class="lines-ref">line 5</span> - the function to initialize the auction</li>
                    <ul>
                        <li><span class="lines-ref">line 36</span> - notify pubfood when done with the  <span class="code-ref">done()</span> callback</li>
                    </ul>
                    <li><span class="lines-ref">line 52</span> - the function to refresh with a new auction for slots</li>
                </ul>
            </div>
            <div class="code-sample">
                <pre id="step4-code" class="prettyprint lang-js linenums">
                </pre>
            </div>
        </div>
        <div class="step">
            <h4>Start the pubfood auction</h4>
            <div class="step-text">Starting a pubfood auction will initiate and orchestrate the steps defined above.
                <ul>
                    <li><span class="lines-ref">line 1</span> - bidders need to respond withing this time</li>
                    <li><span class="lines-ref">line 2</span> - we can observe all events for debugging</li>
                    <li><span class="lines-ref">line 5</span> - finally, start the auction</li>
                </ul>
            </div>
            <div class="code-sample">
                <pre id="step5-code" class="prettyprint lang-js linenums">
                </pre>
            </div>
        </div>
        </div>
        <br>
        <span style="font-size: larger; font-weight: bold">Very good</span>
        You read through the steps.</h3><a href="#theAd"> This is the sample ad rendered by the steps.</a>
        <br>
        <br>
        <div>
            <div id="step"></div>
            <div id="step1"></div>
            <div id="step2"></div>
            <div id="step3"></div>
            <div id="step4"></div>
            <div id="step5"></div>
        </div>
        <script>
         getStep('step0', false);
         getStep('step1');
         getStep('step2');
         getStep('step3');
         getStep('step4');
         getStep('step5');
        </script>
        <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js?skin=sons-of-obsidian"></script>
    </body>
</html>
